# 第一章 概述
## 一些概念
- ISP：互联网提供商
- IXP：互联网交换节点，允许两个网路直接相连并交换分组，不需要再通过第三个网络来转发分组。比如不需要再走主干ISP来转换分组
- 互联网标准化工作：缺乏标准会使得各大厂商由于竞争制定多种自己的标准让消费者左右为难，同时也限制了技术的发展；但是制定的过早又会由于技术不到位重新制定标准，造成浪费
- P2P链接：有别于客户端/服务端的方式，双方都可以发送和服务，下载彼此的硬盘资源等
- 路由器：是实现**分组交换**的关键组件。其任务是转发收到的分组。
- 报文和分组：几个分组一起称为一个报文。因为通常一个报文比较长，我们按照等长的长度比如1024bits分为一个**分组**，也称作**包**。每个分组前面需要加一个首部，包括了比如自己的分组序号等信息。
    - 路由器的转发分组过程：路由器收到一个分组或者说是包，先暂时存储下来，通过检查其头部来寻找地址并转发到对应接口，把分组转发给下一个路由器。这样一步步的可能经过几十台路由器之后会送达目标主机。各路由器之间要经常交换自己的路由信息以便于更新路由表，使得整个转发网络在发生拓扑变化后可以及时更新。
    - 路由器只暂存分组而不是整条报文，因为通常只使用内存来保存数据。还有就是转发分组时，找到路由表准备转发时才会占用链路，其他时间不会占用以达到高效率。
    - 分组交换的优点：动态分配带宽非常灵活；以分组作为传输单位，省去了建立连接的时间，十分迅速；同时也是可靠的。
- 关于bps：bits per second。一般前面跟的是数据量本身的大小，比如10Mbps，是每秒10M bits。而有些地方使用的10MBps，这个B是byte,本身就是bits的8倍大了。这就是**速率**的概念
- 带宽，在计网中指代的是某种通道传输数据的能力，表示**最高传输速率**
- 吞吐量（throughput）。在单位时间内通过某个端口的实际数据数量，是一种现实世界的网络数据测量。受额定的网络带宽等限制。
- 时延。指分组从网络一端到另一端所需的时间。
- 往返时间RTT（Round-Trip Time）。是指交互一次所需的时间，毕竟现在的互联网连接都是双向的。
## 关于OSI七层模型
他只是理想的模型，现如今基于TCP/IP协议的互联网并未严格使用这套模型，理由就是OSI制定太慢也太复杂，并不适合商业用途，而且前者也在上个世纪就早早抢占网络市场，商家不会因此做这么大的动作。由于OSI七层模型概念太多又不实用，TCP/IP的四层协议又掩盖住了很多概念,所以他们的结合:五层模型是平常我们理解计网架构的一个很好的模型.它是由:应用层,传输层,网络层,数据链路和物理层来组成的。其实就是原来的表示层和会话层都合并进入了应用层。应用层就是最上层的协议，协定的是**应用程序之间通信和交互的规则**，如HTTP, DNS, SMTP等，它们使用报文来作为信息交换的单元。运输层就是指提供进程之间通信的通用数据服务。网络层就是负责把运输层产生的报文段或数据包装成分组或者包，用来传输。链路层是两台主机之间链路连接的协议层。物理层主要是规定物理媒体的一些形态，比如电缆插头是几个脚这样的协议，而光缆，双绞线，同轴电缆和无线信道等物理媒体并不是协议本身的东西，它只是物理媒体。

# 第二章 物理层
物理层的最主要功能，就是要保证如何在各种各样的计算机上正确传输比特流。因为现在计算机种类多样，下层的物理媒体更是多种多样，物理层就是要制定正确而完备的协议，让数据链路层可以无视物理媒体的区别，比如光缆啊和普通电缆的区别，他们的引脚数也不同。

## 一些概念
- 信道：Channel。并不是指电线，而是表示向某一个方向传输信息的媒体。因此一条通信电路通常包括一条发送信道，一条接收信道。那么基于信道是否能同时发送接收，我们分单工，半双工和双工通信。
- 调制：modulation。计算机输出的基带信号带有直流和低频成分不能被所有信道传输，这时候就需要调制。调制又分两种，一种是直接改基带信号的波形，称为基带调制，或者直接点就叫编码；另一种就需要基于载波调制，称为带通调制。
- 物理媒体：双绞线，同轴电缆，光缆。
- ADSL：非对称数字用户线，得名来自于上下行速度差别巨大。

# 第三章 链路层
数据链路层点对点信道的协议数据单元叫做**帧**。他是把网络层IP协议发送下来的IP数据报（分组，包）包装成帧。

## 一些概念
- PPP协议，主要适用于点对点的情况，互联网初期是需要稳定可靠的协议，用户量还不大
- MTU，最大传送单元。默认1500字节
- 适用于广播信道的数据链路层。

# 第四章 网络层
不同于电信网路需要建立可靠连接从而造成的大量成本压力，互联网两端由于是智能计算机，拥有优秀的差别检测和区分的能力，所以我们不需要建立多么严谨的连接来保证信息不乱序，不重复。互联网连接只需要：**网络层向传输层提供简单灵活的、无连接的、尽最大努力交付的数据报服务**（注意这个数据报也就是我们说的分组，或者包）。网络层不去管理数据报的顺序，重复和是否出错，以此来选用成本较低，功能简单的路由器从而降低成本。这里提到的所有的信息保障功能全部由运输层来做。

## IP协议
同在网络层的用的比较多的还有ARP（地址解析协议），ICMP（网际控制报文协议），IGMP（网际组管理协议）。

由于全世界各地对网络的需求不一样，这就需要一些中间手段把不同的网络联系在一起，物理层使用转发器，数据链路层使用网桥，网络层的就是路由器，网络层以上就是使用网关。当中间设备是转发器或者网桥的时候，它其实只是把网络扩大了，真正起到选择连接作用的是路由器。

在网络层中，各种异构的网络通过路由器相互连接起来，然后边缘设备通过建立连接来连接到这个大网络来，但是IP层协议把这些异构网络的细节全部遮蔽,使得所有连接进来的设备都认为是同一个网络,这样的网络我们称之IP虚拟网络，或者IP网。如果是基于IP协议的TCP协议那它就是构成我们当今互联网的基础结构了。

### IP地址
32位的唯一标识符。在分类的IP地址分类方法中,有ABCDEF几类，主要是按照网络号的字节数来决定好，前面也有1-3位来决定是ABC哪种网络。然后这32位代码会按照点分十进制法，每8位插一个空格，把这八位的二进制转化为十进制，再把空格换成点来连接起来，就变成了我们今天所认识的IP地址。

### IP地址的一些特点
- 用转发器和网桥连接起来的网络仍属于同一片网络，因为它们具有相同的网络号，这也是构成ip地址的重要组成部分之一
- 122页，图4-8 IP地址和硬件地址的区别

### ARP协议
已经知道了一个主机或路由器的IP地址，如何获得其MAC地址？这就是ARP协议做针对的问题。

### IP数据报结构
IP数据报首部长度固定20字节。IP数据报基本就是头部+数据内容构成，由于IP协议下层的每一种数据链路协议都规定了数据内容字段的最大长度，称为MTU（最大传送单元），如果数据内容大于MTU则就要分片处理了。分片处理主要体现在首部的偏移量里面,以8作为单位,分片长度必须是8的整数倍。

首部的校验和，主要用于检验数据报的首部而不包含数据内容，每次经过路由器都要重算，因为也许发生了新的分片导致偏移量被改变等等。TTL是数据报最大可以被转发跳转的次数。

### 划分子网
简单说，IP地址原来是两级结构，网络号+主机号就能确认一个主机，那这样非免显得有点浪费资源，所以我们可以针对一个主机号，再次划分子网领域，变成三级结构。网络号+主机号+子网号

### 子网掩码
IP数据报首部无法看出是否有子网的划分，所以如何找到正确的子网地址？这就需要子网掩码，和原来的ip进行位与操作就能算出子网的确切地址。

### CIDR编码

## 从VPN到专用网

## 什么是NAT？
专网里的主机在已经得到专网IP地址之后，又想要直接连接互联网且不需要解密的时候，直接申请ipv4不现实，这时候就应该用NAT协议。

# 第五章 运输层
既然已有了网络层的IP协议提供主机到主机的通信服务,为何还需要运输层?区别就在于，其实互联网服务间的通讯是基于主机里的某个进程，也就是说永远都是主机的进程或端口与另一个主机端口进行通信，而非主机本身（这种说法太笼统）。所以就需要更上层的一层协议来做到端口通讯，这就是运输层。

## 一些概念
- TCP和UDP运输实体称为